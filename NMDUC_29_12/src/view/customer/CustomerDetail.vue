<template>
  <div id="dlgPopup" class="m-dialog" :class="{ isShow: isShow }">
    <div class="m-popup-employee">
      <div class="m-popup-employee-header">
        <div class="m-left">
          Th√¥ng tin nh√¢n vi√™n
          <div class="m-header-checkbox">
            <div class="m-checkbox">
              <div class="m-icon-check"></div>
            </div>
            <div class="m-checkbox-text">L√† kh√°ch h√†ng</div>
          </div>
          <div class="m-header-checkbox">
            <div class="m-checkbox">
              <div class="m-icon-check"></div>
            </div>
            <div class="m-checkbox-text">L√† kh√°ch h√†ng</div>
          </div>
        </div>

        <div id="btnCloseDialog" class="m-right">
          <div class="m-icon-question"></div>
          <div class="m-icon-close"></div>
        </div>
      </div>
      <div class="m-popup-employee-content">
        <div class="m-right">
          <div class="m-row-fill">
            <div class="m-fill-in">
              <label for="" class="m-label"> M√£ <span>*</span></label>
              <div class="m-row">
                <input
                  id="txtEmployeeCode"
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  fieldName="EmployeeCode"
                  v-model="customer.CustomerCode"
                />
                <div class="m-wrap-popup-error">
                  <div class="m-popup-error">
                    Th√¥ng tin n√†y kh√¥ng ƒë∆∞·ª£c b·ªè tr·ªëng !
                  </div>
                </div>
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label">T√™n <span>*</span> </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtFullName"
                  fieldName="EmployeeName"
                  v-model="customer.FullName"
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label"> Ng√†y sinh </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="date"
                  name=""
                  id="dtDate"
                  fieldName="DateOfBirth"
                  v-bind:value="
                    customer.DateOfBirth
                      | fomatDataDDMMYYYY(customer.DateOfBirth)
                  "
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label"> Gi·ªõi t√≠nh </label>
              <div class="m-row-radio">
                <div class="m-check">
                  <div class="checkmark"><div class="dot dot-1"></div></div>
                  <div class="container">Nam</div>
                </div>

                <div class="m-check">
                  <div class="checkmark"><div class="dot dot-0"></div></div>
                  <label class="container">N·ªØ</label>
                </div>
                <div class="m-check">
                  <div class="checkmark"><div class="dot dot-2"></div></div>
                  <label class="container">Kh√°c</label>
                </div>
              </div>
            </div>
            <div class="m-fill-in row-2">
              <label for="" class="m-label"> ƒê∆°n v·ªã <span>*</span> </label>
              <div class="m-row">
                <!-- <combobox
                  id="cbxDepartment"
                  api="http://amis.manhnv.net/api/v1/Departments"
                  propertyDisplay="DepartmentName"
                  propertyValue="DepartmentId"
                  fieldName="DepartmentId"
                >
                </combobox> -->
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label"> S·ªë CMND </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id=""
                  fieldName="IdentityNumber"
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label"> Ng√†y c·∫•p </label>
              <div class="m-row">
                <div class="m-row">
                  <input
                    class="m-input"
                    placeholder=""
                    type="date"
                    name=""
                    id="dtDateIdentity"
                    fieldName="IdentityDate"
                  />
                </div>
              </div>
            </div>
            <div class="m-fill-in row-2">
              <label for="" class="m-label"> Ch·ª©c danh </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  fieldName="EmployeePosition"
                />
                <!-- <combobox
                  id="cbxPosition"
                  api="http://amis.manhnv.net/api/v1/Positions"
                  propertyDisplay="PositionName"
                  propertyValue="PositionId"
                  fieldName="PositionId"
                >
                </combobox> -->
              </div>
            </div>
            <div class="m-fill-in row-2">
              <label for="" class="m-label"> N∆°i c·∫•p </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtAddress"
                  fieldName="IdentityPlace"
                />
              </div>
            </div>
          </div>
          <br />
          <div class="m-row-fill">
            <div class="m-fill-in row-full">
              <label for="" class="m-label"> ƒê·ªãa ch·ªâ </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="Address"
                />
              </div>
            </div>
          </div>

          <div class="m-row-fill">
            <div class="m-fill-in">
              <label for="" class="m-label">ƒêT di ƒë·ªông </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="PhoneNumber"
                  v-model="customer.PhoneNumber"
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label">ƒêT c·ªë ƒë·ªãnh </label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="TelephoneNumber"
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label">Email</label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="Email"
                />
              </div>
            </div>
          </div>
          <div class="m-row-fill">
            <div class="m-fill-in">
              <label for="" class="m-label">T√†i kho·∫£n ng√¢n h√†ng</label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="BankAccountNumber"
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label">T√™n ng√¢n h√†ng</label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="BankName"
                />
              </div>
            </div>
            <div class="m-fill-in">
              <label for="" class="m-label">Chi nh√°nh</label>
              <div class="m-row">
                <input
                  class="m-input"
                  placeholder=""
                  type="text"
                  name=""
                  id="txtEmail"
                  fieldName="BankBranchName"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="m-row-rim">
        <div class="m-rim"></div>
      </div>
      <div class="m-popup-employee-footer">
        <div class="left-footer">
          <button
            id="btnCloseDialog"
            @click="btnCancelOnclick()"
            class="m-btn m-continue"
          >
            H·ªßy
          </button>
        </div>
        <div class="right-footer">
          <button id="btnSave" class="m-btn m-continue">C·∫•t</button>
          <button
            id="btnSave-Add"
            class="m-btn m-close"
            @click="btnSaveOnclick()"
          >
            C·∫•t v√† Th√™m
          </button>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import axios from "axios";
export default {
  name: "CustomerDetail",
  methods: {
    btnCancelOnclick: function () {
      this.$emit("resetOldId");
      this.customer = {};
      this.$emit("showDialog", false);
      this.$emit("loadData");
    },

    btnSaveOnclick: function () {
      var me = this;
      if (this.customerId == null) {
        axios({
          method: "post",
          url: "http://cukcuk.manhnv.net/api/v1/Customerss",
          data: this.customer,
        })
          .then(function (response) {
            me.$parent.loadData(); //g·ªçi cha load l·∫°i
            me.btnCancelOnclick();
            if (response && response.data) console.log("Success!");
          })
          .catch(function (error) {
            console.log(error);
          });
      } else {
        console.log("this.customer s·ª≠a" + this.customer);
        axios
          .put(
            `http://cukcuk.manhnv.net/api/v1/Customerss/${this.customerId}`,
            this.customer
          )
          .then(function (res) {
            console.log(res);
            //ƒë√≥ng popup
            me.$emit("showDialog", false);
          })
          .catch((res) => {
            console.log(res);
            alert("th√™m kh√¥ng th√†nh c√¥ng");
          });
      }
    },
  },

  filters: {
    fomatDataDDMMYYYY(date) {
      console.log(date);
      return "20-09-2001";
    },
  },
  watch: {
    CustomerCode: function (value) {
      this.customer = { CustomerCode: value };
    },
    customerId: function (value) {
      var me = this;
      if (value != null) {
        // s·ª≠a
        //todo g·ªçi api l·∫•y d·ªØ li·ªáu
        axios
          .get(`http://cukcuk.manhnv.net/api/v1/Customerss/${value}`)
          .then(function (res) {
            me.customer = res.data;
          })
          .catch(function (err) {
            console.log("üöÄ ~ file: CustomerDetail.vue ~ line 301 ~ err", err);
          });
      }
    },
  },
  props: {
    customerId: {
      default: null,
      type: String,
    },
    isShow: {
      default: null,
      type: Boolean,
    },
    CustomerCode: {
      default: null,
      type: String,
    },
  },

  data() {
    return {
      customer: {},
    };
  },
};
</script>